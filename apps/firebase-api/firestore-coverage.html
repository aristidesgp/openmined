<!DOCTYPE html>
<meta charset="utf-8">
<title>Firestore Rule Coverage Report</title>
<style>
.coverage-expr {
  padding-bottom: 4px;
  display: inline-block;
  border-bottom: 3px solid black;
  vertical-align: top;
}
.coverage-expr:hover {
  background-color: rgba(255, 100, 100, 0.2);
  cursor: default;
  border-bottom: 3px solid red;
}
</style>

<script>
// Populated by the emulator at runtime
const data = {
  "rules": {
    "files": [{
      "content": "rules_version \u003d \u00272\u0027;\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    function existingData() {\n      return resource.data;\n    }\n\n    function incomingData() {\n      return request.resource.data;\n    }\n\n    function getUserData(user) {\n      return get(/databases/$(database)/documents/users/$(user));\n    }\n\n    function isAdmin(user) {\n      return exists(/databases/$(database)/documents/admins/$(user));\n    }\n\n    function isLoggedIn() {\n      return request.auth !\u003d null;\n    }\n\n    function isSameUser(user) {\n      return isLoggedIn() \u0026\u0026 request.auth.uid \u003d\u003d user;\n    }\n\n    match /users/{user} {\n      // Anyone can read\n      allow read;\n\n      // Owner can only write all fields except \"is_mentor\"\n      allow write: if isSameUser(user) \u0026\u0026 !(\u0027is_mentor\u0027 in incomingData()) \u0026\u0026 !(\u0027mentorable_courses\u0027 in incomingData())\n\n      // Only owner can read/write\n      match /private/{privateUserVar} {\n        allow read, write: if isSameUser(user)\n      }\n\n      // Only for mentors\n      match /reviews/{review} {\n        // TODO: Students who don\u0027t have a role of mentor cannot create records on the reviews subcollection\n        // TODO: Students who are also mentors cannot review their own submission\n        // TODO: Students who are also mentors cannot create a review for a course they are not allowed to mentor (mentors can only review courses they\u0027re allowed to review)\n        // TODO: Students who are also mentors cannot edit or delete a review, only read and create\n        allow read: if isSameUser(user)\n        allow create, update: if isSameUser(user)\n      }\n\n      match /courses/{course} {\n        function hasStartedCourse(u) {\n          return (started_at in u) \u0026\u0026 !!u.started_at;\n        }\n\n        function hasCompletedCourse(u) {\n          return hasStartedCourse(u) \u0026\u0026 !!u.completed_at\n        }\n\n        // TODO: Mentor will need to be able to edit the submissions array with the status and reviewed_at time (project-\u003epart-\u003esubmissions)\n        // TODO: Mentors should always be able to read any user that they are assigned to review\n        // TODO (MAYBE): Student should not be able to mark their submissions with the data of \"status\" or \"reviewed_at\"\n        allow read, write: if isSameUser(user)\n\n        // These are submissions of a student\n        // But remember, this DOES NOT affect how a mentor would read this submission\n        match /submissions/{submission} {\n          allow read: if isSameUser(user) || get(existingData().mentor).id \u003d\u003d request.auth.uid;\n          allow create: if isSameUser(user)\n          allow update: if get(existingData().mentor).id \u003d\u003d request.auth.uid;\n          allow delete: if false;\n        }\n\n        match /feedback/{conceptOrLesson} {\n          allow read, write: if isSameUser(user)\n        }\n      }\n    }\n\n    // This allows for the collectionGroup queries to be read by mentors\n    match /{path\u003d**}/submissions/{submission} {\n      // TODO: The only users who should be able to hit this endpoint must be mentors (the code below should work, but needs testing)\n      // NOTE: This should only be triggered from line 66 of the users/dashboard/Mentor.tsx file\n      allow read: if isLoggedIn() \u0026\u0026 getUserData(request.auth.uid).data.is_mentor;\n      allow read: if false;\n    }\n\n    match /{document\u003d**} {\n      allow read, write: if false;\n    }\n  }\n}\n"
    }]
  },
  "report": [{
    "sourcePosition": {
      "line": 6,
      "column": 14,
      "currentOffset": 133,
      "endOffset": 145
    },
    "children": [{
      "sourcePosition": {
        "line": 6,
        "column": 14,
        "currentOffset": 133,
        "endOffset": 140
      }
    }]
  }, {
    "sourcePosition": {
      "line": 10,
      "column": 14,
      "currentOffset": 198,
      "endOffset": 218
    },
    "values": [{
      "value": {
        "mapValue": {
          "fields": {
            "first_name": {
              "stringValue": "Alice"
            }
          }
        }
      },
      "count": 4
    }, {
      "value": {
        "mapValue": {
          "fields": {
            "is_mentor": {
              "boolValue": true
            }
          }
        }
      },
      "count": 2
    }, {
      "value": {
        "mapValue": {
          "fields": {
            "mentorable_courses": {
              "listValue": {
                "values": [{
                  "stringValue": "some-course"
                }, {
                  "stringValue": "some-other-course"
                }]
              }
            }
          }
        }
      },
      "count": 4
    }],
    "children": [{
      "sourcePosition": {
        "line": 10,
        "column": 14,
        "currentOffset": 198,
        "endOffset": 213
      },
      "values": [{
        "value": {
          "mapValue": {
            "fields": {
              "data": {
                "mapValue": {
                  "fields": {
                    "first_name": {
                      "stringValue": "Alice"
                    }
                  }
                }
              },
              "__name__": {
                "pathValue": {
                  "segments": [{
                    "simple": "databases"
                  }, {
                    "simple": "(default)"
                  }, {
                    "simple": "documents"
                  }, {
                    "simple": "users"
                  }, {
                    "simple": "alice"
                  }]
                }
              },
              "id": {
                "stringValue": "alice"
              }
            }
          }
        },
        "count": 4
      }, {
        "value": {
          "mapValue": {
            "fields": {
              "data": {
                "mapValue": {
                  "fields": {
                    "is_mentor": {
                      "boolValue": true
                    }
                  }
                }
              },
              "__name__": {
                "pathValue": {
                  "segments": [{
                    "simple": "databases"
                  }, {
                    "simple": "(default)"
                  }, {
                    "simple": "documents"
                  }, {
                    "simple": "users"
                  }, {
                    "simple": "alice"
                  }]
                }
              },
              "id": {
                "stringValue": "alice"
              }
            }
          }
        },
        "count": 2
      }, {
        "value": {
          "mapValue": {
            "fields": {
              "data": {
                "mapValue": {
                  "fields": {
                    "mentorable_courses": {
                      "listValue": {
                        "values": [{
                          "stringValue": "some-course"
                        }, {
                          "stringValue": "some-other-course"
                        }]
                      }
                    }
                  }
                }
              },
              "__name__": {
                "pathValue": {
                  "segments": [{
                    "simple": "databases"
                  }, {
                    "simple": "(default)"
                  }, {
                    "simple": "documents"
                  }, {
                    "simple": "users"
                  }, {
                    "simple": "alice"
                  }]
                }
              },
              "id": {
                "stringValue": "alice"
              }
            }
          }
        },
        "count": 4
      }],
      "children": [{
        "sourcePosition": {
          "line": 10,
          "column": 14,
          "currentOffset": 198,
          "endOffset": 204
        },
        "values": [{
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.603Z"
                },
                "auth": {
                  "mapValue": {
                    "fields": {
                      "uid": {
                        "stringValue": "alice"
                      },
                      "token": {
                        "mapValue": {
                          "fields": {
                            "iss": {
                              "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                            },
                            "aud": {
                              "stringValue": "firestore-emulator-example"
                            },
                            "iat": {
                              "intValue": "0"
                            },
                            "exp": {
                              "intValue": "3600"
                            },
                            "auth_time": {
                              "intValue": "0"
                            },
                            "sub": {
                              "stringValue": "alice"
                            },
                            "user_id": {
                              "stringValue": "alice"
                            },
                            "firebase": {
                              "mapValue": {
                                "fields": {
                                  "sign_in_provider": {
                                    "stringValue": "custom"
                                  },
                                  "identities": {
                                    "mapValue": {
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": true
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }]
                  }
                },
                "transforms": {
                  "nullValue": null
                },
                "writeFields": {
                  "nullValue": null
                },
                "readFields": {
                  "nullValue": null
                },
                "resource": {
                  "mapValue": {
                    "fields": {
                      "data": {
                        "mapValue": {
                          "fields": {
                            "first_name": {
                              "stringValue": "Alice"
                            }
                          }
                        }
                      },
                      "__name__": {
                        "pathValue": {
                          "segments": [{
                            "simple": "databases"
                          }, {
                            "simple": "(default)"
                          }, {
                            "simple": "documents"
                          }, {
                            "simple": "users"
                          }, {
                            "simple": "alice"
                          }]
                        }
                      },
                      "id": {
                        "stringValue": "alice"
                      }
                    }
                  }
                },
                "method": {
                  "stringValue": "create"
                }
              }
            }
          },
          "count": 4
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.613Z"
                },
                "auth": {
                  "mapValue": {
                    "fields": {
                      "uid": {
                        "stringValue": "alice"
                      },
                      "token": {
                        "mapValue": {
                          "fields": {
                            "iss": {
                              "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                            },
                            "aud": {
                              "stringValue": "firestore-emulator-example"
                            },
                            "iat": {
                              "intValue": "0"
                            },
                            "exp": {
                              "intValue": "3600"
                            },
                            "auth_time": {
                              "intValue": "0"
                            },
                            "sub": {
                              "stringValue": "alice"
                            },
                            "user_id": {
                              "stringValue": "alice"
                            },
                            "firebase": {
                              "mapValue": {
                                "fields": {
                                  "sign_in_provider": {
                                    "stringValue": "custom"
                                  },
                                  "identities": {
                                    "mapValue": {
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": true
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }]
                  }
                },
                "transforms": {
                  "nullValue": null
                },
                "writeFields": {
                  "nullValue": null
                },
                "readFields": {
                  "nullValue": null
                },
                "resource": {
                  "mapValue": {
                    "fields": {
                      "data": {
                        "mapValue": {
                          "fields": {
                            "is_mentor": {
                              "boolValue": true
                            }
                          }
                        }
                      },
                      "__name__": {
                        "pathValue": {
                          "segments": [{
                            "simple": "databases"
                          }, {
                            "simple": "(default)"
                          }, {
                            "simple": "documents"
                          }, {
                            "simple": "users"
                          }, {
                            "simple": "alice"
                          }]
                        }
                      },
                      "id": {
                        "stringValue": "alice"
                      }
                    }
                  }
                },
                "method": {
                  "stringValue": "update"
                }
              }
            }
          },
          "count": 2
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.638Z"
                },
                "auth": {
                  "mapValue": {
                    "fields": {
                      "uid": {
                        "stringValue": "alice"
                      },
                      "token": {
                        "mapValue": {
                          "fields": {
                            "iss": {
                              "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                            },
                            "aud": {
                              "stringValue": "firestore-emulator-example"
                            },
                            "iat": {
                              "intValue": "0"
                            },
                            "exp": {
                              "intValue": "3600"
                            },
                            "auth_time": {
                              "intValue": "0"
                            },
                            "sub": {
                              "stringValue": "alice"
                            },
                            "user_id": {
                              "stringValue": "alice"
                            },
                            "firebase": {
                              "mapValue": {
                                "fields": {
                                  "sign_in_provider": {
                                    "stringValue": "custom"
                                  },
                                  "identities": {
                                    "mapValue": {
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": true
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }]
                  }
                },
                "transforms": {
                  "nullValue": null
                },
                "writeFields": {
                  "nullValue": null
                },
                "readFields": {
                  "nullValue": null
                },
                "resource": {
                  "mapValue": {
                    "fields": {
                      "data": {
                        "mapValue": {
                          "fields": {
                            "mentorable_courses": {
                              "listValue": {
                                "values": [{
                                  "stringValue": "some-course"
                                }, {
                                  "stringValue": "some-other-course"
                                }]
                              }
                            }
                          }
                        }
                      },
                      "__name__": {
                        "pathValue": {
                          "segments": [{
                            "simple": "databases"
                          }, {
                            "simple": "(default)"
                          }, {
                            "simple": "documents"
                          }, {
                            "simple": "users"
                          }, {
                            "simple": "alice"
                          }]
                        }
                      },
                      "id": {
                        "stringValue": "alice"
                      }
                    }
                  }
                },
                "method": {
                  "stringValue": "update"
                }
              }
            }
          },
          "count": 4
        }]
      }]
    }]
  }, {
    "sourcePosition": {
      "line": 14,
      "column": 14,
      "currentOffset": 274,
      "endOffset": 322
    },
    "children": [{
      "sourcePosition": {
        "line": 14,
        "column": 18,
        "currentOffset": 278,
        "endOffset": 322
      },
      "children": [{
        "sourcePosition": {
          "line": 14,
          "column": 31,
          "currentOffset": 291,
          "endOffset": 298
        }
      }, {
        "sourcePosition": {
          "line": 14,
          "column": 59,
          "currentOffset": 319,
          "endOffset": 322
        }
      }]
    }]
  }, {
    "sourcePosition": {
      "line": 18,
      "column": 14,
      "currentOffset": 376,
      "endOffset": 428
    },
    "children": [{
      "sourcePosition": {
        "line": 18,
        "column": 21,
        "currentOffset": 383,
        "endOffset": 428
      },
      "children": [{
        "sourcePosition": {
          "line": 18,
          "column": 34,
          "currentOffset": 396,
          "endOffset": 403
        }
      }, {
        "sourcePosition": {
          "line": 18,
          "column": 63,
          "currentOffset": 425,
          "endOffset": 428
        }
      }]
    }]
  }, {
    "sourcePosition": {
      "line": 22,
      "column": 14,
      "currentOffset": 481,
      "endOffset": 500
    },
    "values": [{
      "value": {
        "boolValue": true
      },
      "count": 26
    }, {
      "value": {
        "boolValue": false
      },
      "count": 10
    }],
    "children": [{
      "sourcePosition": {
        "line": 22,
        "column": 14,
        "currentOffset": 481,
        "endOffset": 492
      },
      "values": [{
        "value": {
          "mapValue": {
            "fields": {
              "uid": {
                "stringValue": "alice"
              },
              "token": {
                "mapValue": {
                  "fields": {
                    "iss": {
                      "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                    },
                    "aud": {
                      "stringValue": "firestore-emulator-example"
                    },
                    "iat": {
                      "intValue": "0"
                    },
                    "exp": {
                      "intValue": "3600"
                    },
                    "auth_time": {
                      "intValue": "0"
                    },
                    "sub": {
                      "stringValue": "alice"
                    },
                    "user_id": {
                      "stringValue": "alice"
                    },
                    "firebase": {
                      "mapValue": {
                        "fields": {
                          "sign_in_provider": {
                            "stringValue": "custom"
                          },
                          "identities": {
                            "mapValue": {
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "count": 16
      }, {
        "value": {
          "nullValue": null
        },
        "count": 10
      }, {
        "value": {
          "mapValue": {
            "fields": {
              "uid": {
                "stringValue": "bob"
              },
              "token": {
                "mapValue": {
                  "fields": {
                    "iss": {
                      "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                    },
                    "aud": {
                      "stringValue": "firestore-emulator-example"
                    },
                    "iat": {
                      "intValue": "0"
                    },
                    "exp": {
                      "intValue": "3600"
                    },
                    "auth_time": {
                      "intValue": "0"
                    },
                    "sub": {
                      "stringValue": "bob"
                    },
                    "user_id": {
                      "stringValue": "bob"
                    },
                    "firebase": {
                      "mapValue": {
                        "fields": {
                          "sign_in_provider": {
                            "stringValue": "custom"
                          },
                          "identities": {
                            "mapValue": {
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "count": 10
      }],
      "children": [{
        "sourcePosition": {
          "line": 22,
          "column": 14,
          "currentOffset": 481,
          "endOffset": 487
        },
        "values": [{
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.387Z"
                },
                "auth": {
                  "mapValue": {
                    "fields": {
                      "uid": {
                        "stringValue": "alice"
                      },
                      "token": {
                        "mapValue": {
                          "fields": {
                            "iss": {
                              "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                            },
                            "aud": {
                              "stringValue": "firestore-emulator-example"
                            },
                            "iat": {
                              "intValue": "0"
                            },
                            "exp": {
                              "intValue": "3600"
                            },
                            "auth_time": {
                              "intValue": "0"
                            },
                            "sub": {
                              "stringValue": "alice"
                            },
                            "user_id": {
                              "stringValue": "alice"
                            },
                            "firebase": {
                              "mapValue": {
                                "fields": {
                                  "sign_in_provider": {
                                    "stringValue": "custom"
                                  },
                                  "identities": {
                                    "mapValue": {
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": true
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }, {
                      "simple": "courses"
                    }, {
                      "simple": "random_course"
                    }]
                  }
                },
                "transforms": {
                  "nullValue": null
                },
                "writeFields": {
                  "nullValue": null
                },
                "readFields": {
                  "nullValue": null
                },
                "resource": {
                  "mapValue": {
                    "fields": {
                      "data": {
                        "mapValue": {
                          "fields": {
                            "started_at": {
                              "timestampValue": "2020-12-23T12:43:00.260Z"
                            }
                          }
                        }
                      },
                      "__name__": {
                        "pathValue": {
                          "segments": [{
                            "simple": "databases"
                          }, {
                            "simple": "(default)"
                          }, {
                            "simple": "documents"
                          }, {
                            "simple": "users"
                          }, {
                            "simple": "alice"
                          }, {
                            "simple": "courses"
                          }, {
                            "simple": "random_course"
                          }]
                        }
                      },
                      "id": {
                        "stringValue": "random_course"
                      }
                    }
                  }
                },
                "method": {
                  "stringValue": "create"
                }
              }
            }
          },
          "count": 2
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.519Z"
                },
                "auth": {
                  "mapValue": {
                    "fields": {
                      "uid": {
                        "stringValue": "alice"
                      },
                      "token": {
                        "mapValue": {
                          "fields": {
                            "iss": {
                              "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                            },
                            "aud": {
                              "stringValue": "firestore-emulator-example"
                            },
                            "iat": {
                              "intValue": "0"
                            },
                            "exp": {
                              "intValue": "3600"
                            },
                            "auth_time": {
                              "intValue": "0"
                            },
                            "sub": {
                              "stringValue": "alice"
                            },
                            "user_id": {
                              "stringValue": "alice"
                            },
                            "firebase": {
                              "mapValue": {
                                "fields": {
                                  "sign_in_provider": {
                                    "stringValue": "custom"
                                  },
                                  "identities": {
                                    "mapValue": {
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": false
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }, {
                      "simple": "courses"
                    }, {
                      "simple": "random_course"
                    }]
                  }
                },
                "fields": {
                  "nullValue": null
                },
                "method": {
                  "stringValue": "get"
                }
              }
            }
          },
          "count": 4
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.575Z"
                },
                "auth": {
                  "nullValue": null
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": false
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }, {
                      "simple": "courses"
                    }, {
                      "simple": "random_course"
                    }]
                  }
                },
                "fields": {
                  "nullValue": null
                },
                "method": {
                  "stringValue": "get"
                }
              }
            }
          },
          "count": 2
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.601Z"
                },
                "auth": {
                  "nullValue": null
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": true
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }, {
                      "simple": "courses"
                    }, {
                      "simple": "random_course"
                    }]
                  }
                },
                "transforms": {
                  "nullValue": null
                },
                "writeFields": {
                  "nullValue": null
                },
                "readFields": {
                  "nullValue": null
                },
                "resource": {
                  "mapValue": {
                    "fields": {
                      "data": {
                        "mapValue": {
                          "fields": {
                            "started_at": {
                              "timestampValue": "2020-12-23T12:43:00.260Z"
                            }
                          }
                        }
                      },
                      "__name__": {
                        "pathValue": {
                          "segments": [{
                            "simple": "databases"
                          }, {
                            "simple": "(default)"
                          }, {
                            "simple": "documents"
                          }, {
                            "simple": "users"
                          }, {
                            "simple": "alice"
                          }, {
                            "simple": "courses"
                          }, {
                            "simple": "random_course"
                          }]
                        }
                      },
                      "id": {
                        "stringValue": "random_course"
                      }
                    }
                  }
                },
                "method": {
                  "stringValue": "create"
                }
              }
            }
          },
          "count": 2
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.603Z"
                },
                "auth": {
                  "mapValue": {
                    "fields": {
                      "uid": {
                        "stringValue": "alice"
                      },
                      "token": {
                        "mapValue": {
                          "fields": {
                            "iss": {
                              "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                            },
                            "aud": {
                              "stringValue": "firestore-emulator-example"
                            },
                            "iat": {
                              "intValue": "0"
                            },
                            "exp": {
                              "intValue": "3600"
                            },
                            "auth_time": {
                              "intValue": "0"
                            },
                            "sub": {
                              "stringValue": "alice"
                            },
                            "user_id": {
                              "stringValue": "alice"
                            },
                            "firebase": {
                              "mapValue": {
                                "fields": {
                                  "sign_in_provider": {
                                    "stringValue": "custom"
                                  },
                                  "identities": {
                                    "mapValue": {
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": true
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }]
                  }
                },
                "transforms": {
                  "nullValue": null
                },
                "writeFields": {
                  "nullValue": null
                },
                "readFields": {
                  "nullValue": null
                },
                "resource": {
                  "mapValue": {
                    "fields": {
                      "data": {
                        "mapValue": {
                          "fields": {
                            "first_name": {
                              "stringValue": "Alice"
                            }
                          }
                        }
                      },
                      "__name__": {
                        "pathValue": {
                          "segments": [{
                            "simple": "databases"
                          }, {
                            "simple": "(default)"
                          }, {
                            "simple": "documents"
                          }, {
                            "simple": "users"
                          }, {
                            "simple": "alice"
                          }]
                        }
                      },
                      "id": {
                        "stringValue": "alice"
                      }
                    }
                  }
                },
                "method": {
                  "stringValue": "create"
                }
              }
            }
          },
          "count": 2
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.613Z"
                },
                "auth": {
                  "mapValue": {
                    "fields": {
                      "uid": {
                        "stringValue": "alice"
                      },
                      "token": {
                        "mapValue": {
                          "fields": {
                            "iss": {
                              "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                            },
                            "aud": {
                              "stringValue": "firestore-emulator-example"
                            },
                            "iat": {
                              "intValue": "0"
                            },
                            "exp": {
                              "intValue": "3600"
                            },
                            "auth_time": {
                              "intValue": "0"
                            },
                            "sub": {
                              "stringValue": "alice"
                            },
                            "user_id": {
                              "stringValue": "alice"
                            },
                            "firebase": {
                              "mapValue": {
                                "fields": {
                                  "sign_in_provider": {
                                    "stringValue": "custom"
                                  },
                                  "identities": {
                                    "mapValue": {
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": true
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }]
                  }
                },
                "transforms": {
                  "nullValue": null
                },
                "writeFields": {
                  "nullValue": null
                },
                "readFields": {
                  "nullValue": null
                },
                "resource": {
                  "mapValue": {
                    "fields": {
                      "data": {
                        "mapValue": {
                          "fields": {
                            "is_mentor": {
                              "boolValue": true
                            }
                          }
                        }
                      },
                      "__name__": {
                        "pathValue": {
                          "segments": [{
                            "simple": "databases"
                          }, {
                            "simple": "(default)"
                          }, {
                            "simple": "documents"
                          }, {
                            "simple": "users"
                          }, {
                            "simple": "alice"
                          }]
                        }
                      },
                      "id": {
                        "stringValue": "alice"
                      }
                    }
                  }
                },
                "method": {
                  "stringValue": "update"
                }
              }
            }
          },
          "count": 2
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.638Z"
                },
                "auth": {
                  "mapValue": {
                    "fields": {
                      "uid": {
                        "stringValue": "alice"
                      },
                      "token": {
                        "mapValue": {
                          "fields": {
                            "iss": {
                              "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                            },
                            "aud": {
                              "stringValue": "firestore-emulator-example"
                            },
                            "iat": {
                              "intValue": "0"
                            },
                            "exp": {
                              "intValue": "3600"
                            },
                            "auth_time": {
                              "intValue": "0"
                            },
                            "sub": {
                              "stringValue": "alice"
                            },
                            "user_id": {
                              "stringValue": "alice"
                            },
                            "firebase": {
                              "mapValue": {
                                "fields": {
                                  "sign_in_provider": {
                                    "stringValue": "custom"
                                  },
                                  "identities": {
                                    "mapValue": {
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": true
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }]
                  }
                },
                "transforms": {
                  "nullValue": null
                },
                "writeFields": {
                  "nullValue": null
                },
                "readFields": {
                  "nullValue": null
                },
                "resource": {
                  "mapValue": {
                    "fields": {
                      "data": {
                        "mapValue": {
                          "fields": {
                            "mentorable_courses": {
                              "listValue": {
                                "values": [{
                                  "stringValue": "some-course"
                                }, {
                                  "stringValue": "some-other-course"
                                }]
                              }
                            }
                          }
                        }
                      },
                      "__name__": {
                        "pathValue": {
                          "segments": [{
                            "simple": "databases"
                          }, {
                            "simple": "(default)"
                          }, {
                            "simple": "documents"
                          }, {
                            "simple": "users"
                          }, {
                            "simple": "alice"
                          }]
                        }
                      },
                      "id": {
                        "stringValue": "alice"
                      }
                    }
                  }
                },
                "method": {
                  "stringValue": "update"
                }
              }
            }
          },
          "count": 2
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.657Z"
                },
                "auth": {
                  "mapValue": {
                    "fields": {
                      "uid": {
                        "stringValue": "bob"
                      },
                      "token": {
                        "mapValue": {
                          "fields": {
                            "iss": {
                              "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                            },
                            "aud": {
                              "stringValue": "firestore-emulator-example"
                            },
                            "iat": {
                              "intValue": "0"
                            },
                            "exp": {
                              "intValue": "3600"
                            },
                            "auth_time": {
                              "intValue": "0"
                            },
                            "sub": {
                              "stringValue": "bob"
                            },
                            "user_id": {
                              "stringValue": "bob"
                            },
                            "firebase": {
                              "mapValue": {
                                "fields": {
                                  "sign_in_provider": {
                                    "stringValue": "custom"
                                  },
                                  "identities": {
                                    "mapValue": {
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": false
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }, {
                      "simple": "courses"
                    }, {
                      "simple": "random_course"
                    }]
                  }
                },
                "fields": {
                  "nullValue": null
                },
                "method": {
                  "stringValue": "get"
                }
              }
            }
          },
          "count": 2
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.671Z"
                },
                "auth": {
                  "mapValue": {
                    "fields": {
                      "uid": {
                        "stringValue": "bob"
                      },
                      "token": {
                        "mapValue": {
                          "fields": {
                            "iss": {
                              "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                            },
                            "aud": {
                              "stringValue": "firestore-emulator-example"
                            },
                            "iat": {
                              "intValue": "0"
                            },
                            "exp": {
                              "intValue": "3600"
                            },
                            "auth_time": {
                              "intValue": "0"
                            },
                            "sub": {
                              "stringValue": "bob"
                            },
                            "user_id": {
                              "stringValue": "bob"
                            },
                            "firebase": {
                              "mapValue": {
                                "fields": {
                                  "sign_in_provider": {
                                    "stringValue": "custom"
                                  },
                                  "identities": {
                                    "mapValue": {
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": true
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }, {
                      "simple": "courses"
                    }, {
                      "simple": "random_course"
                    }]
                  }
                },
                "transforms": {
                  "nullValue": null
                },
                "writeFields": {
                  "nullValue": null
                },
                "readFields": {
                  "nullValue": null
                },
                "resource": {
                  "mapValue": {
                    "fields": {
                      "data": {
                        "mapValue": {
                          "fields": {
                            "started_at": {
                              "timestampValue": "2020-12-23T12:43:00.260Z"
                            }
                          }
                        }
                      },
                      "__name__": {
                        "pathValue": {
                          "segments": [{
                            "simple": "databases"
                          }, {
                            "simple": "(default)"
                          }, {
                            "simple": "documents"
                          }, {
                            "simple": "users"
                          }, {
                            "simple": "alice"
                          }, {
                            "simple": "courses"
                          }, {
                            "simple": "random_course"
                          }]
                        }
                      },
                      "id": {
                        "stringValue": "random_course"
                      }
                    }
                  }
                },
                "method": {
                  "stringValue": "create"
                }
              }
            }
          },
          "count": 2
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.680Z"
                },
                "auth": {
                  "nullValue": null
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": true
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }]
                  }
                },
                "transforms": {
                  "nullValue": null
                },
                "writeFields": {
                  "nullValue": null
                },
                "readFields": {
                  "nullValue": null
                },
                "resource": {
                  "mapValue": {
                    "fields": {
                      "data": {
                        "mapValue": {
                          "fields": {
                            "first_name": {
                              "stringValue": "Alice"
                            }
                          }
                        }
                      },
                      "__name__": {
                        "pathValue": {
                          "segments": [{
                            "simple": "databases"
                          }, {
                            "simple": "(default)"
                          }, {
                            "simple": "documents"
                          }, {
                            "simple": "users"
                          }, {
                            "simple": "alice"
                          }]
                        }
                      },
                      "id": {
                        "stringValue": "alice"
                      }
                    }
                  }
                },
                "method": {
                  "stringValue": "update"
                }
              }
            }
          },
          "count": 2
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.725Z"
                },
                "auth": {
                  "mapValue": {
                    "fields": {
                      "uid": {
                        "stringValue": "bob"
                      },
                      "token": {
                        "mapValue": {
                          "fields": {
                            "iss": {
                              "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                            },
                            "aud": {
                              "stringValue": "firestore-emulator-example"
                            },
                            "iat": {
                              "intValue": "0"
                            },
                            "exp": {
                              "intValue": "3600"
                            },
                            "auth_time": {
                              "intValue": "0"
                            },
                            "sub": {
                              "stringValue": "bob"
                            },
                            "user_id": {
                              "stringValue": "bob"
                            },
                            "firebase": {
                              "mapValue": {
                                "fields": {
                                  "sign_in_provider": {
                                    "stringValue": "custom"
                                  },
                                  "identities": {
                                    "mapValue": {
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": true
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }]
                  }
                },
                "transforms": {
                  "nullValue": null
                },
                "writeFields": {
                  "nullValue": null
                },
                "readFields": {
                  "nullValue": null
                },
                "resource": {
                  "mapValue": {
                    "fields": {
                      "data": {
                        "mapValue": {
                          "fields": {
                            "first_name": {
                              "stringValue": "Alice"
                            }
                          }
                        }
                      },
                      "__name__": {
                        "pathValue": {
                          "segments": [{
                            "simple": "databases"
                          }, {
                            "simple": "(default)"
                          }, {
                            "simple": "documents"
                          }, {
                            "simple": "users"
                          }, {
                            "simple": "alice"
                          }]
                        }
                      },
                      "id": {
                        "stringValue": "alice"
                      }
                    }
                  }
                },
                "method": {
                  "stringValue": "update"
                }
              }
            }
          },
          "count": 2
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.780Z"
                },
                "auth": {
                  "mapValue": {
                    "fields": {
                      "uid": {
                        "stringValue": "alice"
                      },
                      "token": {
                        "mapValue": {
                          "fields": {
                            "iss": {
                              "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                            },
                            "aud": {
                              "stringValue": "firestore-emulator-example"
                            },
                            "iat": {
                              "intValue": "0"
                            },
                            "exp": {
                              "intValue": "3600"
                            },
                            "auth_time": {
                              "intValue": "0"
                            },
                            "sub": {
                              "stringValue": "alice"
                            },
                            "user_id": {
                              "stringValue": "alice"
                            },
                            "firebase": {
                              "mapValue": {
                                "fields": {
                                  "sign_in_provider": {
                                    "stringValue": "custom"
                                  },
                                  "identities": {
                                    "mapValue": {
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": true
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }, {
                      "simple": "private"
                    }, {
                      "simple": "alice"
                    }]
                  }
                },
                "transforms": {
                  "nullValue": null
                },
                "writeFields": {
                  "nullValue": null
                },
                "readFields": {
                  "nullValue": null
                },
                "resource": {
                  "mapValue": {
                    "fields": {
                      "data": {
                        "mapValue": {
                          "fields": {
                            "github_id": {
                              "stringValue": "token"
                            }
                          }
                        }
                      },
                      "__name__": {
                        "pathValue": {
                          "segments": [{
                            "simple": "databases"
                          }, {
                            "simple": "(default)"
                          }, {
                            "simple": "documents"
                          }, {
                            "simple": "users"
                          }, {
                            "simple": "alice"
                          }, {
                            "simple": "private"
                          }, {
                            "simple": "alice"
                          }]
                        }
                      },
                      "id": {
                        "stringValue": "alice"
                      }
                    }
                  }
                },
                "method": {
                  "stringValue": "create"
                }
              }
            }
          },
          "count": 2
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.790Z"
                },
                "auth": {
                  "mapValue": {
                    "fields": {
                      "uid": {
                        "stringValue": "alice"
                      },
                      "token": {
                        "mapValue": {
                          "fields": {
                            "iss": {
                              "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                            },
                            "aud": {
                              "stringValue": "firestore-emulator-example"
                            },
                            "iat": {
                              "intValue": "0"
                            },
                            "exp": {
                              "intValue": "3600"
                            },
                            "auth_time": {
                              "intValue": "0"
                            },
                            "sub": {
                              "stringValue": "alice"
                            },
                            "user_id": {
                              "stringValue": "alice"
                            },
                            "firebase": {
                              "mapValue": {
                                "fields": {
                                  "sign_in_provider": {
                                    "stringValue": "custom"
                                  },
                                  "identities": {
                                    "mapValue": {
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": false
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }, {
                      "simple": "private"
                    }, {
                      "simple": "alice"
                    }]
                  }
                },
                "fields": {
                  "nullValue": null
                },
                "method": {
                  "stringValue": "get"
                }
              }
            }
          },
          "count": 2
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.836Z"
                },
                "auth": {
                  "nullValue": null
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": false
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }, {
                      "simple": "private"
                    }, {
                      "simple": "alice"
                    }]
                  }
                },
                "fields": {
                  "nullValue": null
                },
                "method": {
                  "stringValue": "get"
                }
              }
            }
          },
          "count": 2
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.850Z"
                },
                "auth": {
                  "nullValue": null
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": true
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }, {
                      "simple": "private"
                    }, {
                      "simple": "alice"
                    }]
                  }
                },
                "transforms": {
                  "nullValue": null
                },
                "writeFields": {
                  "nullValue": null
                },
                "readFields": {
                  "nullValue": null
                },
                "resource": {
                  "mapValue": {
                    "fields": {
                      "data": {
                        "mapValue": {
                          "fields": {
                            "github_id": {
                              "stringValue": "token"
                            }
                          }
                        }
                      },
                      "__name__": {
                        "pathValue": {
                          "segments": [{
                            "simple": "databases"
                          }, {
                            "simple": "(default)"
                          }, {
                            "simple": "documents"
                          }, {
                            "simple": "users"
                          }, {
                            "simple": "alice"
                          }, {
                            "simple": "private"
                          }, {
                            "simple": "alice"
                          }]
                        }
                      },
                      "id": {
                        "stringValue": "alice"
                      }
                    }
                  }
                },
                "method": {
                  "stringValue": "update"
                }
              }
            }
          },
          "count": 2
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.888Z"
                },
                "auth": {
                  "mapValue": {
                    "fields": {
                      "uid": {
                        "stringValue": "bob"
                      },
                      "token": {
                        "mapValue": {
                          "fields": {
                            "iss": {
                              "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                            },
                            "aud": {
                              "stringValue": "firestore-emulator-example"
                            },
                            "iat": {
                              "intValue": "0"
                            },
                            "exp": {
                              "intValue": "3600"
                            },
                            "auth_time": {
                              "intValue": "0"
                            },
                            "sub": {
                              "stringValue": "bob"
                            },
                            "user_id": {
                              "stringValue": "bob"
                            },
                            "firebase": {
                              "mapValue": {
                                "fields": {
                                  "sign_in_provider": {
                                    "stringValue": "custom"
                                  },
                                  "identities": {
                                    "mapValue": {
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": false
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }, {
                      "simple": "private"
                    }, {
                      "simple": "alice"
                    }]
                  }
                },
                "fields": {
                  "nullValue": null
                },
                "method": {
                  "stringValue": "get"
                }
              }
            }
          },
          "count": 2
        }, {
          "value": {
            "mapValue": {
              "fields": {
                "time": {
                  "timestampValue": "2020-12-23T12:43:00.902Z"
                },
                "auth": {
                  "mapValue": {
                    "fields": {
                      "uid": {
                        "stringValue": "bob"
                      },
                      "token": {
                        "mapValue": {
                          "fields": {
                            "iss": {
                              "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                            },
                            "aud": {
                              "stringValue": "firestore-emulator-example"
                            },
                            "iat": {
                              "intValue": "0"
                            },
                            "exp": {
                              "intValue": "3600"
                            },
                            "auth_time": {
                              "intValue": "0"
                            },
                            "sub": {
                              "stringValue": "bob"
                            },
                            "user_id": {
                              "stringValue": "bob"
                            },
                            "firebase": {
                              "mapValue": {
                                "fields": {
                                  "sign_in_provider": {
                                    "stringValue": "custom"
                                  },
                                  "identities": {
                                    "mapValue": {
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "headers": {
                  "mapValue": {
                  }
                },
                "inTransaction": {
                  "boolValue": true
                },
                "path": {
                  "pathValue": {
                    "segments": [{
                      "simple": "databases"
                    }, {
                      "simple": "(default)"
                    }, {
                      "simple": "documents"
                    }, {
                      "simple": "users"
                    }, {
                      "simple": "alice"
                    }, {
                      "simple": "private"
                    }, {
                      "simple": "alice"
                    }]
                  }
                },
                "transforms": {
                  "nullValue": null
                },
                "writeFields": {
                  "nullValue": null
                },
                "readFields": {
                  "nullValue": null
                },
                "resource": {
                  "mapValue": {
                    "fields": {
                      "data": {
                        "mapValue": {
                          "fields": {
                            "github_id": {
                              "stringValue": "token"
                            }
                          }
                        }
                      },
                      "__name__": {
                        "pathValue": {
                          "segments": [{
                            "simple": "databases"
                          }, {
                            "simple": "(default)"
                          }, {
                            "simple": "documents"
                          }, {
                            "simple": "users"
                          }, {
                            "simple": "alice"
                          }, {
                            "simple": "private"
                          }, {
                            "simple": "alice"
                          }]
                        }
                      },
                      "id": {
                        "stringValue": "alice"
                      }
                    }
                  }
                },
                "method": {
                  "stringValue": "update"
                }
              }
            }
          },
          "count": 2
        }]
      }]
    }]
  }, {
    "sourcePosition": {
      "line": 26,
      "column": 14,
      "currentOffset": 555,
      "endOffset": 594
    },
    "values": [{
      "value": {
        "boolValue": true
      },
      "count": 16
    }, {
      "value": {
        "boolValue": false
      },
      "count": 20
    }],
    "children": [{
      "sourcePosition": {
        "line": 26,
        "column": 14,
        "currentOffset": 555,
        "endOffset": 564
      },
      "values": [{
        "value": {
          "boolValue": true
        },
        "count": 26
      }, {
        "value": {
          "boolValue": false
        },
        "count": 10
      }]
    }, {
      "sourcePosition": {
        "line": 26,
        "column": 30,
        "currentOffset": 571,
        "endOffset": 594
      },
      "values": [{
        "value": {
          "boolValue": true
        },
        "count": 16
      }, {
        "value": {
        },
        "count": 10
      }, {
        "value": {
          "boolValue": false
        },
        "count": 10
      }],
      "children": [{
        "sourcePosition": {
          "line": 26,
          "column": 30,
          "currentOffset": 571,
          "endOffset": 586
        },
        "values": [{
          "value": {
            "stringValue": "alice"
          },
          "count": 16
        }, {
          "value": {
          },
          "count": 10
        }, {
          "value": {
            "stringValue": "bob"
          },
          "count": 10
        }],
        "children": [{
          "sourcePosition": {
            "line": 26,
            "column": 30,
            "currentOffset": 571,
            "endOffset": 582
          },
          "values": [{
            "value": {
              "mapValue": {
                "fields": {
                  "uid": {
                    "stringValue": "alice"
                  },
                  "token": {
                    "mapValue": {
                      "fields": {
                        "iss": {
                          "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                        },
                        "aud": {
                          "stringValue": "firestore-emulator-example"
                        },
                        "iat": {
                          "intValue": "0"
                        },
                        "exp": {
                          "intValue": "3600"
                        },
                        "auth_time": {
                          "intValue": "0"
                        },
                        "sub": {
                          "stringValue": "alice"
                        },
                        "user_id": {
                          "stringValue": "alice"
                        },
                        "firebase": {
                          "mapValue": {
                            "fields": {
                              "sign_in_provider": {
                                "stringValue": "custom"
                              },
                              "identities": {
                                "mapValue": {
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "count": 16
          }, {
            "value": {
            },
            "count": 10
          }, {
            "value": {
              "mapValue": {
                "fields": {
                  "uid": {
                    "stringValue": "bob"
                  },
                  "token": {
                    "mapValue": {
                      "fields": {
                        "iss": {
                          "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                        },
                        "aud": {
                          "stringValue": "firestore-emulator-example"
                        },
                        "iat": {
                          "intValue": "0"
                        },
                        "exp": {
                          "intValue": "3600"
                        },
                        "auth_time": {
                          "intValue": "0"
                        },
                        "sub": {
                          "stringValue": "bob"
                        },
                        "user_id": {
                          "stringValue": "bob"
                        },
                        "firebase": {
                          "mapValue": {
                            "fields": {
                              "sign_in_provider": {
                                "stringValue": "custom"
                              },
                              "identities": {
                                "mapValue": {
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "count": 10
          }],
          "children": [{
            "sourcePosition": {
              "line": 26,
              "column": 30,
              "currentOffset": 571,
              "endOffset": 577
            },
            "values": [{
              "value": {
                "mapValue": {
                  "fields": {
                    "time": {
                      "timestampValue": "2020-12-23T12:43:00.387Z"
                    },
                    "auth": {
                      "mapValue": {
                        "fields": {
                          "uid": {
                            "stringValue": "alice"
                          },
                          "token": {
                            "mapValue": {
                              "fields": {
                                "iss": {
                                  "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                                },
                                "aud": {
                                  "stringValue": "firestore-emulator-example"
                                },
                                "iat": {
                                  "intValue": "0"
                                },
                                "exp": {
                                  "intValue": "3600"
                                },
                                "auth_time": {
                                  "intValue": "0"
                                },
                                "sub": {
                                  "stringValue": "alice"
                                },
                                "user_id": {
                                  "stringValue": "alice"
                                },
                                "firebase": {
                                  "mapValue": {
                                    "fields": {
                                      "sign_in_provider": {
                                        "stringValue": "custom"
                                      },
                                      "identities": {
                                        "mapValue": {
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "headers": {
                      "mapValue": {
                      }
                    },
                    "inTransaction": {
                      "boolValue": true
                    },
                    "path": {
                      "pathValue": {
                        "segments": [{
                          "simple": "databases"
                        }, {
                          "simple": "(default)"
                        }, {
                          "simple": "documents"
                        }, {
                          "simple": "users"
                        }, {
                          "simple": "alice"
                        }, {
                          "simple": "courses"
                        }, {
                          "simple": "random_course"
                        }]
                      }
                    },
                    "transforms": {
                      "nullValue": null
                    },
                    "writeFields": {
                      "nullValue": null
                    },
                    "readFields": {
                      "nullValue": null
                    },
                    "resource": {
                      "mapValue": {
                        "fields": {
                          "data": {
                            "mapValue": {
                              "fields": {
                                "started_at": {
                                  "timestampValue": "2020-12-23T12:43:00.260Z"
                                }
                              }
                            }
                          },
                          "__name__": {
                            "pathValue": {
                              "segments": [{
                                "simple": "databases"
                              }, {
                                "simple": "(default)"
                              }, {
                                "simple": "documents"
                              }, {
                                "simple": "users"
                              }, {
                                "simple": "alice"
                              }, {
                                "simple": "courses"
                              }, {
                                "simple": "random_course"
                              }]
                            }
                          },
                          "id": {
                            "stringValue": "random_course"
                          }
                        }
                      }
                    },
                    "method": {
                      "stringValue": "create"
                    }
                  }
                }
              },
              "count": 2
            }, {
              "value": {
                "mapValue": {
                  "fields": {
                    "time": {
                      "timestampValue": "2020-12-23T12:43:00.519Z"
                    },
                    "auth": {
                      "mapValue": {
                        "fields": {
                          "uid": {
                            "stringValue": "alice"
                          },
                          "token": {
                            "mapValue": {
                              "fields": {
                                "iss": {
                                  "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                                },
                                "aud": {
                                  "stringValue": "firestore-emulator-example"
                                },
                                "iat": {
                                  "intValue": "0"
                                },
                                "exp": {
                                  "intValue": "3600"
                                },
                                "auth_time": {
                                  "intValue": "0"
                                },
                                "sub": {
                                  "stringValue": "alice"
                                },
                                "user_id": {
                                  "stringValue": "alice"
                                },
                                "firebase": {
                                  "mapValue": {
                                    "fields": {
                                      "sign_in_provider": {
                                        "stringValue": "custom"
                                      },
                                      "identities": {
                                        "mapValue": {
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "headers": {
                      "mapValue": {
                      }
                    },
                    "inTransaction": {
                      "boolValue": false
                    },
                    "path": {
                      "pathValue": {
                        "segments": [{
                          "simple": "databases"
                        }, {
                          "simple": "(default)"
                        }, {
                          "simple": "documents"
                        }, {
                          "simple": "users"
                        }, {
                          "simple": "alice"
                        }, {
                          "simple": "courses"
                        }, {
                          "simple": "random_course"
                        }]
                      }
                    },
                    "fields": {
                      "nullValue": null
                    },
                    "method": {
                      "stringValue": "get"
                    }
                  }
                }
              },
              "count": 4
            }, {
              "value": {
              },
              "count": 10
            }, {
              "value": {
                "mapValue": {
                  "fields": {
                    "time": {
                      "timestampValue": "2020-12-23T12:43:00.603Z"
                    },
                    "auth": {
                      "mapValue": {
                        "fields": {
                          "uid": {
                            "stringValue": "alice"
                          },
                          "token": {
                            "mapValue": {
                              "fields": {
                                "iss": {
                                  "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                                },
                                "aud": {
                                  "stringValue": "firestore-emulator-example"
                                },
                                "iat": {
                                  "intValue": "0"
                                },
                                "exp": {
                                  "intValue": "3600"
                                },
                                "auth_time": {
                                  "intValue": "0"
                                },
                                "sub": {
                                  "stringValue": "alice"
                                },
                                "user_id": {
                                  "stringValue": "alice"
                                },
                                "firebase": {
                                  "mapValue": {
                                    "fields": {
                                      "sign_in_provider": {
                                        "stringValue": "custom"
                                      },
                                      "identities": {
                                        "mapValue": {
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "headers": {
                      "mapValue": {
                      }
                    },
                    "inTransaction": {
                      "boolValue": true
                    },
                    "path": {
                      "pathValue": {
                        "segments": [{
                          "simple": "databases"
                        }, {
                          "simple": "(default)"
                        }, {
                          "simple": "documents"
                        }, {
                          "simple": "users"
                        }, {
                          "simple": "alice"
                        }]
                      }
                    },
                    "transforms": {
                      "nullValue": null
                    },
                    "writeFields": {
                      "nullValue": null
                    },
                    "readFields": {
                      "nullValue": null
                    },
                    "resource": {
                      "mapValue": {
                        "fields": {
                          "data": {
                            "mapValue": {
                              "fields": {
                                "first_name": {
                                  "stringValue": "Alice"
                                }
                              }
                            }
                          },
                          "__name__": {
                            "pathValue": {
                              "segments": [{
                                "simple": "databases"
                              }, {
                                "simple": "(default)"
                              }, {
                                "simple": "documents"
                              }, {
                                "simple": "users"
                              }, {
                                "simple": "alice"
                              }]
                            }
                          },
                          "id": {
                            "stringValue": "alice"
                          }
                        }
                      }
                    },
                    "method": {
                      "stringValue": "create"
                    }
                  }
                }
              },
              "count": 2
            }, {
              "value": {
                "mapValue": {
                  "fields": {
                    "time": {
                      "timestampValue": "2020-12-23T12:43:00.613Z"
                    },
                    "auth": {
                      "mapValue": {
                        "fields": {
                          "uid": {
                            "stringValue": "alice"
                          },
                          "token": {
                            "mapValue": {
                              "fields": {
                                "iss": {
                                  "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                                },
                                "aud": {
                                  "stringValue": "firestore-emulator-example"
                                },
                                "iat": {
                                  "intValue": "0"
                                },
                                "exp": {
                                  "intValue": "3600"
                                },
                                "auth_time": {
                                  "intValue": "0"
                                },
                                "sub": {
                                  "stringValue": "alice"
                                },
                                "user_id": {
                                  "stringValue": "alice"
                                },
                                "firebase": {
                                  "mapValue": {
                                    "fields": {
                                      "sign_in_provider": {
                                        "stringValue": "custom"
                                      },
                                      "identities": {
                                        "mapValue": {
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "headers": {
                      "mapValue": {
                      }
                    },
                    "inTransaction": {
                      "boolValue": true
                    },
                    "path": {
                      "pathValue": {
                        "segments": [{
                          "simple": "databases"
                        }, {
                          "simple": "(default)"
                        }, {
                          "simple": "documents"
                        }, {
                          "simple": "users"
                        }, {
                          "simple": "alice"
                        }]
                      }
                    },
                    "transforms": {
                      "nullValue": null
                    },
                    "writeFields": {
                      "nullValue": null
                    },
                    "readFields": {
                      "nullValue": null
                    },
                    "resource": {
                      "mapValue": {
                        "fields": {
                          "data": {
                            "mapValue": {
                              "fields": {
                                "is_mentor": {
                                  "boolValue": true
                                }
                              }
                            }
                          },
                          "__name__": {
                            "pathValue": {
                              "segments": [{
                                "simple": "databases"
                              }, {
                                "simple": "(default)"
                              }, {
                                "simple": "documents"
                              }, {
                                "simple": "users"
                              }, {
                                "simple": "alice"
                              }]
                            }
                          },
                          "id": {
                            "stringValue": "alice"
                          }
                        }
                      }
                    },
                    "method": {
                      "stringValue": "update"
                    }
                  }
                }
              },
              "count": 2
            }, {
              "value": {
                "mapValue": {
                  "fields": {
                    "time": {
                      "timestampValue": "2020-12-23T12:43:00.638Z"
                    },
                    "auth": {
                      "mapValue": {
                        "fields": {
                          "uid": {
                            "stringValue": "alice"
                          },
                          "token": {
                            "mapValue": {
                              "fields": {
                                "iss": {
                                  "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                                },
                                "aud": {
                                  "stringValue": "firestore-emulator-example"
                                },
                                "iat": {
                                  "intValue": "0"
                                },
                                "exp": {
                                  "intValue": "3600"
                                },
                                "auth_time": {
                                  "intValue": "0"
                                },
                                "sub": {
                                  "stringValue": "alice"
                                },
                                "user_id": {
                                  "stringValue": "alice"
                                },
                                "firebase": {
                                  "mapValue": {
                                    "fields": {
                                      "sign_in_provider": {
                                        "stringValue": "custom"
                                      },
                                      "identities": {
                                        "mapValue": {
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "headers": {
                      "mapValue": {
                      }
                    },
                    "inTransaction": {
                      "boolValue": true
                    },
                    "path": {
                      "pathValue": {
                        "segments": [{
                          "simple": "databases"
                        }, {
                          "simple": "(default)"
                        }, {
                          "simple": "documents"
                        }, {
                          "simple": "users"
                        }, {
                          "simple": "alice"
                        }]
                      }
                    },
                    "transforms": {
                      "nullValue": null
                    },
                    "writeFields": {
                      "nullValue": null
                    },
                    "readFields": {
                      "nullValue": null
                    },
                    "resource": {
                      "mapValue": {
                        "fields": {
                          "data": {
                            "mapValue": {
                              "fields": {
                                "mentorable_courses": {
                                  "listValue": {
                                    "values": [{
                                      "stringValue": "some-course"
                                    }, {
                                      "stringValue": "some-other-course"
                                    }]
                                  }
                                }
                              }
                            }
                          },
                          "__name__": {
                            "pathValue": {
                              "segments": [{
                                "simple": "databases"
                              }, {
                                "simple": "(default)"
                              }, {
                                "simple": "documents"
                              }, {
                                "simple": "users"
                              }, {
                                "simple": "alice"
                              }]
                            }
                          },
                          "id": {
                            "stringValue": "alice"
                          }
                        }
                      }
                    },
                    "method": {
                      "stringValue": "update"
                    }
                  }
                }
              },
              "count": 2
            }, {
              "value": {
                "mapValue": {
                  "fields": {
                    "time": {
                      "timestampValue": "2020-12-23T12:43:00.657Z"
                    },
                    "auth": {
                      "mapValue": {
                        "fields": {
                          "uid": {
                            "stringValue": "bob"
                          },
                          "token": {
                            "mapValue": {
                              "fields": {
                                "iss": {
                                  "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                                },
                                "aud": {
                                  "stringValue": "firestore-emulator-example"
                                },
                                "iat": {
                                  "intValue": "0"
                                },
                                "exp": {
                                  "intValue": "3600"
                                },
                                "auth_time": {
                                  "intValue": "0"
                                },
                                "sub": {
                                  "stringValue": "bob"
                                },
                                "user_id": {
                                  "stringValue": "bob"
                                },
                                "firebase": {
                                  "mapValue": {
                                    "fields": {
                                      "sign_in_provider": {
                                        "stringValue": "custom"
                                      },
                                      "identities": {
                                        "mapValue": {
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "headers": {
                      "mapValue": {
                      }
                    },
                    "inTransaction": {
                      "boolValue": false
                    },
                    "path": {
                      "pathValue": {
                        "segments": [{
                          "simple": "databases"
                        }, {
                          "simple": "(default)"
                        }, {
                          "simple": "documents"
                        }, {
                          "simple": "users"
                        }, {
                          "simple": "alice"
                        }, {
                          "simple": "courses"
                        }, {
                          "simple": "random_course"
                        }]
                      }
                    },
                    "fields": {
                      "nullValue": null
                    },
                    "method": {
                      "stringValue": "get"
                    }
                  }
                }
              },
              "count": 2
            }, {
              "value": {
                "mapValue": {
                  "fields": {
                    "time": {
                      "timestampValue": "2020-12-23T12:43:00.671Z"
                    },
                    "auth": {
                      "mapValue": {
                        "fields": {
                          "uid": {
                            "stringValue": "bob"
                          },
                          "token": {
                            "mapValue": {
                              "fields": {
                                "iss": {
                                  "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                                },
                                "aud": {
                                  "stringValue": "firestore-emulator-example"
                                },
                                "iat": {
                                  "intValue": "0"
                                },
                                "exp": {
                                  "intValue": "3600"
                                },
                                "auth_time": {
                                  "intValue": "0"
                                },
                                "sub": {
                                  "stringValue": "bob"
                                },
                                "user_id": {
                                  "stringValue": "bob"
                                },
                                "firebase": {
                                  "mapValue": {
                                    "fields": {
                                      "sign_in_provider": {
                                        "stringValue": "custom"
                                      },
                                      "identities": {
                                        "mapValue": {
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "headers": {
                      "mapValue": {
                      }
                    },
                    "inTransaction": {
                      "boolValue": true
                    },
                    "path": {
                      "pathValue": {
                        "segments": [{
                          "simple": "databases"
                        }, {
                          "simple": "(default)"
                        }, {
                          "simple": "documents"
                        }, {
                          "simple": "users"
                        }, {
                          "simple": "alice"
                        }, {
                          "simple": "courses"
                        }, {
                          "simple": "random_course"
                        }]
                      }
                    },
                    "transforms": {
                      "nullValue": null
                    },
                    "writeFields": {
                      "nullValue": null
                    },
                    "readFields": {
                      "nullValue": null
                    },
                    "resource": {
                      "mapValue": {
                        "fields": {
                          "data": {
                            "mapValue": {
                              "fields": {
                                "started_at": {
                                  "timestampValue": "2020-12-23T12:43:00.260Z"
                                }
                              }
                            }
                          },
                          "__name__": {
                            "pathValue": {
                              "segments": [{
                                "simple": "databases"
                              }, {
                                "simple": "(default)"
                              }, {
                                "simple": "documents"
                              }, {
                                "simple": "users"
                              }, {
                                "simple": "alice"
                              }, {
                                "simple": "courses"
                              }, {
                                "simple": "random_course"
                              }]
                            }
                          },
                          "id": {
                            "stringValue": "random_course"
                          }
                        }
                      }
                    },
                    "method": {
                      "stringValue": "create"
                    }
                  }
                }
              },
              "count": 2
            }, {
              "value": {
                "mapValue": {
                  "fields": {
                    "time": {
                      "timestampValue": "2020-12-23T12:43:00.725Z"
                    },
                    "auth": {
                      "mapValue": {
                        "fields": {
                          "uid": {
                            "stringValue": "bob"
                          },
                          "token": {
                            "mapValue": {
                              "fields": {
                                "iss": {
                                  "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                                },
                                "aud": {
                                  "stringValue": "firestore-emulator-example"
                                },
                                "iat": {
                                  "intValue": "0"
                                },
                                "exp": {
                                  "intValue": "3600"
                                },
                                "auth_time": {
                                  "intValue": "0"
                                },
                                "sub": {
                                  "stringValue": "bob"
                                },
                                "user_id": {
                                  "stringValue": "bob"
                                },
                                "firebase": {
                                  "mapValue": {
                                    "fields": {
                                      "sign_in_provider": {
                                        "stringValue": "custom"
                                      },
                                      "identities": {
                                        "mapValue": {
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "headers": {
                      "mapValue": {
                      }
                    },
                    "inTransaction": {
                      "boolValue": true
                    },
                    "path": {
                      "pathValue": {
                        "segments": [{
                          "simple": "databases"
                        }, {
                          "simple": "(default)"
                        }, {
                          "simple": "documents"
                        }, {
                          "simple": "users"
                        }, {
                          "simple": "alice"
                        }]
                      }
                    },
                    "transforms": {
                      "nullValue": null
                    },
                    "writeFields": {
                      "nullValue": null
                    },
                    "readFields": {
                      "nullValue": null
                    },
                    "resource": {
                      "mapValue": {
                        "fields": {
                          "data": {
                            "mapValue": {
                              "fields": {
                                "first_name": {
                                  "stringValue": "Alice"
                                }
                              }
                            }
                          },
                          "__name__": {
                            "pathValue": {
                              "segments": [{
                                "simple": "databases"
                              }, {
                                "simple": "(default)"
                              }, {
                                "simple": "documents"
                              }, {
                                "simple": "users"
                              }, {
                                "simple": "alice"
                              }]
                            }
                          },
                          "id": {
                            "stringValue": "alice"
                          }
                        }
                      }
                    },
                    "method": {
                      "stringValue": "update"
                    }
                  }
                }
              },
              "count": 2
            }, {
              "value": {
                "mapValue": {
                  "fields": {
                    "time": {
                      "timestampValue": "2020-12-23T12:43:00.780Z"
                    },
                    "auth": {
                      "mapValue": {
                        "fields": {
                          "uid": {
                            "stringValue": "alice"
                          },
                          "token": {
                            "mapValue": {
                              "fields": {
                                "iss": {
                                  "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                                },
                                "aud": {
                                  "stringValue": "firestore-emulator-example"
                                },
                                "iat": {
                                  "intValue": "0"
                                },
                                "exp": {
                                  "intValue": "3600"
                                },
                                "auth_time": {
                                  "intValue": "0"
                                },
                                "sub": {
                                  "stringValue": "alice"
                                },
                                "user_id": {
                                  "stringValue": "alice"
                                },
                                "firebase": {
                                  "mapValue": {
                                    "fields": {
                                      "sign_in_provider": {
                                        "stringValue": "custom"
                                      },
                                      "identities": {
                                        "mapValue": {
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "headers": {
                      "mapValue": {
                      }
                    },
                    "inTransaction": {
                      "boolValue": true
                    },
                    "path": {
                      "pathValue": {
                        "segments": [{
                          "simple": "databases"
                        }, {
                          "simple": "(default)"
                        }, {
                          "simple": "documents"
                        }, {
                          "simple": "users"
                        }, {
                          "simple": "alice"
                        }, {
                          "simple": "private"
                        }, {
                          "simple": "alice"
                        }]
                      }
                    },
                    "transforms": {
                      "nullValue": null
                    },
                    "writeFields": {
                      "nullValue": null
                    },
                    "readFields": {
                      "nullValue": null
                    },
                    "resource": {
                      "mapValue": {
                        "fields": {
                          "data": {
                            "mapValue": {
                              "fields": {
                                "github_id": {
                                  "stringValue": "token"
                                }
                              }
                            }
                          },
                          "__name__": {
                            "pathValue": {
                              "segments": [{
                                "simple": "databases"
                              }, {
                                "simple": "(default)"
                              }, {
                                "simple": "documents"
                              }, {
                                "simple": "users"
                              }, {
                                "simple": "alice"
                              }, {
                                "simple": "private"
                              }, {
                                "simple": "alice"
                              }]
                            }
                          },
                          "id": {
                            "stringValue": "alice"
                          }
                        }
                      }
                    },
                    "method": {
                      "stringValue": "create"
                    }
                  }
                }
              },
              "count": 2
            }, {
              "value": {
                "mapValue": {
                  "fields": {
                    "time": {
                      "timestampValue": "2020-12-23T12:43:00.790Z"
                    },
                    "auth": {
                      "mapValue": {
                        "fields": {
                          "uid": {
                            "stringValue": "alice"
                          },
                          "token": {
                            "mapValue": {
                              "fields": {
                                "iss": {
                                  "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                                },
                                "aud": {
                                  "stringValue": "firestore-emulator-example"
                                },
                                "iat": {
                                  "intValue": "0"
                                },
                                "exp": {
                                  "intValue": "3600"
                                },
                                "auth_time": {
                                  "intValue": "0"
                                },
                                "sub": {
                                  "stringValue": "alice"
                                },
                                "user_id": {
                                  "stringValue": "alice"
                                },
                                "firebase": {
                                  "mapValue": {
                                    "fields": {
                                      "sign_in_provider": {
                                        "stringValue": "custom"
                                      },
                                      "identities": {
                                        "mapValue": {
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "headers": {
                      "mapValue": {
                      }
                    },
                    "inTransaction": {
                      "boolValue": false
                    },
                    "path": {
                      "pathValue": {
                        "segments": [{
                          "simple": "databases"
                        }, {
                          "simple": "(default)"
                        }, {
                          "simple": "documents"
                        }, {
                          "simple": "users"
                        }, {
                          "simple": "alice"
                        }, {
                          "simple": "private"
                        }, {
                          "simple": "alice"
                        }]
                      }
                    },
                    "fields": {
                      "nullValue": null
                    },
                    "method": {
                      "stringValue": "get"
                    }
                  }
                }
              },
              "count": 2
            }, {
              "value": {
                "mapValue": {
                  "fields": {
                    "time": {
                      "timestampValue": "2020-12-23T12:43:00.888Z"
                    },
                    "auth": {
                      "mapValue": {
                        "fields": {
                          "uid": {
                            "stringValue": "bob"
                          },
                          "token": {
                            "mapValue": {
                              "fields": {
                                "iss": {
                                  "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                                },
                                "aud": {
                                  "stringValue": "firestore-emulator-example"
                                },
                                "iat": {
                                  "intValue": "0"
                                },
                                "exp": {
                                  "intValue": "3600"
                                },
                                "auth_time": {
                                  "intValue": "0"
                                },
                                "sub": {
                                  "stringValue": "bob"
                                },
                                "user_id": {
                                  "stringValue": "bob"
                                },
                                "firebase": {
                                  "mapValue": {
                                    "fields": {
                                      "sign_in_provider": {
                                        "stringValue": "custom"
                                      },
                                      "identities": {
                                        "mapValue": {
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "headers": {
                      "mapValue": {
                      }
                    },
                    "inTransaction": {
                      "boolValue": false
                    },
                    "path": {
                      "pathValue": {
                        "segments": [{
                          "simple": "databases"
                        }, {
                          "simple": "(default)"
                        }, {
                          "simple": "documents"
                        }, {
                          "simple": "users"
                        }, {
                          "simple": "alice"
                        }, {
                          "simple": "private"
                        }, {
                          "simple": "alice"
                        }]
                      }
                    },
                    "fields": {
                      "nullValue": null
                    },
                    "method": {
                      "stringValue": "get"
                    }
                  }
                }
              },
              "count": 2
            }, {
              "value": {
                "mapValue": {
                  "fields": {
                    "time": {
                      "timestampValue": "2020-12-23T12:43:00.902Z"
                    },
                    "auth": {
                      "mapValue": {
                        "fields": {
                          "uid": {
                            "stringValue": "bob"
                          },
                          "token": {
                            "mapValue": {
                              "fields": {
                                "iss": {
                                  "stringValue": "https://securetoken.google.com/firestore-emulator-example"
                                },
                                "aud": {
                                  "stringValue": "firestore-emulator-example"
                                },
                                "iat": {
                                  "intValue": "0"
                                },
                                "exp": {
                                  "intValue": "3600"
                                },
                                "auth_time": {
                                  "intValue": "0"
                                },
                                "sub": {
                                  "stringValue": "bob"
                                },
                                "user_id": {
                                  "stringValue": "bob"
                                },
                                "firebase": {
                                  "mapValue": {
                                    "fields": {
                                      "sign_in_provider": {
                                        "stringValue": "custom"
                                      },
                                      "identities": {
                                        "mapValue": {
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "headers": {
                      "mapValue": {
                      }
                    },
                    "inTransaction": {
                      "boolValue": true
                    },
                    "path": {
                      "pathValue": {
                        "segments": [{
                          "simple": "databases"
                        }, {
                          "simple": "(default)"
                        }, {
                          "simple": "documents"
                        }, {
                          "simple": "users"
                        }, {
                          "simple": "alice"
                        }, {
                          "simple": "private"
                        }, {
                          "simple": "alice"
                        }]
                      }
                    },
                    "transforms": {
                      "nullValue": null
                    },
                    "writeFields": {
                      "nullValue": null
                    },
                    "readFields": {
                      "nullValue": null
                    },
                    "resource": {
                      "mapValue": {
                        "fields": {
                          "data": {
                            "mapValue": {
                              "fields": {
                                "github_id": {
                                  "stringValue": "token"
                                }
                              }
                            }
                          },
                          "__name__": {
                            "pathValue": {
                              "segments": [{
                                "simple": "databases"
                              }, {
                                "simple": "(default)"
                              }, {
                                "simple": "documents"
                              }, {
                                "simple": "users"
                              }, {
                                "simple": "alice"
                              }, {
                                "simple": "private"
                              }, {
                                "simple": "alice"
                              }]
                            }
                          },
                          "id": {
                            "stringValue": "alice"
                          }
                        }
                      }
                    },
                    "method": {
                      "stringValue": "update"
                    }
                  }
                }
              },
              "count": 2
            }]
          }]
        }]
      }, {
        "sourcePosition": {
          "line": 26,
          "column": 50,
          "currentOffset": 591,
          "endOffset": 594
        },
        "values": [{
          "value": {
            "stringValue": "alice"
          },
          "count": 26
        }, {
          "value": {
          },
          "count": 10
        }]
      }]
    }]
  }, {
    "sourcePosition": {
      "line": 38,
      "column": 31,
      "currentOffset": 960,
      "endOffset": 974
    },
    "values": [{
      "value": {
        "boolValue": true
      },
      "count": 4
    }, {
      "value": {
        "boolValue": false
      },
      "count": 8
    }],
    "children": [{
      "sourcePosition": {
        "line": 38,
        "column": 42,
        "currentOffset": 971,
        "endOffset": 974
      },
      "values": [{
        "value": {
          "stringValue": "alice"
        },
        "count": 12
      }]
    }]
  }, {
    "sourcePosition": {
      "line": 47,
      "column": 24,
      "currentOffset": 1532,
      "endOffset": 1546
    },
    "children": [{
      "sourcePosition": {
        "line": 47,
        "column": 35,
        "currentOffset": 1543,
        "endOffset": 1546
      }
    }]
  }, {
    "sourcePosition": {
      "line": 48,
      "column": 34,
      "currentOffset": 1582,
      "endOffset": 1596
    },
    "children": [{
      "sourcePosition": {
        "line": 48,
        "column": 45,
        "currentOffset": 1593,
        "endOffset": 1596
      }
    }]
  }, {
    "sourcePosition": {
      "line": 53,
      "column": 18,
      "currentOffset": 1696,
      "endOffset": 1730
    },
    "children": [{
      "sourcePosition": {
        "line": 53,
        "column": 18,
        "currentOffset": 1696,
        "endOffset": 1711
      },
      "children": [{
        "sourcePosition": {
          "line": 53,
          "column": 33,
          "currentOffset": 1711,
          "endOffset": 1711
        }
      }, {
        "sourcePosition": {
          "line": 53,
          "column": 19,
          "currentOffset": 1697,
          "endOffset": 1706
        }
      }]
    }, {
      "sourcePosition": {
        "line": 53,
        "column": 39,
        "currentOffset": 1717,
        "endOffset": 1730
      },
      "children": [{
        "sourcePosition": {
          "line": 53,
          "column": 40,
          "currentOffset": 1718,
          "endOffset": 1730
        },
        "children": [{
          "sourcePosition": {
            "line": 53,
            "column": 41,
            "currentOffset": 1719,
            "endOffset": 1730
          },
          "children": [{
            "sourcePosition": {
              "line": 53,
              "column": 41,
              "currentOffset": 1719,
              "endOffset": 1719
            }
          }]
        }]
      }]
    }]
  }, {
    "sourcePosition": {
      "line": 57,
      "column": 18,
      "currentOffset": 1802,
      "endOffset": 1840
    },
    "children": [{
      "sourcePosition": {
        "line": 57,
        "column": 18,
        "currentOffset": 1802,
        "endOffset": 1819
      },
      "children": [{
        "sourcePosition": {
          "line": 57,
          "column": 35,
          "currentOffset": 1819,
          "endOffset": 1819
        }
      }]
    }, {
      "sourcePosition": {
        "line": 57,
        "column": 41,
        "currentOffset": 1825,
        "endOffset": 1840
      },
      "children": [{
        "sourcePosition": {
          "line": 57,
          "column": 42,
          "currentOffset": 1826,
          "endOffset": 1840
        },
        "children": [{
          "sourcePosition": {
            "line": 57,
            "column": 43,
            "currentOffset": 1827,
            "endOffset": 1840
          },
          "children": [{
            "sourcePosition": {
              "line": 57,
              "column": 43,
              "currentOffset": 1827,
              "endOffset": 1827
            }
          }]
        }]
      }]
    }]
  }, {
    "sourcePosition": {
      "line": 68,
      "column": 26,
      "currentOffset": 2459,
      "endOffset": 2527
    },
    "children": [{
      "sourcePosition": {
        "line": 68,
        "column": 26,
        "currentOffset": 2459,
        "endOffset": 2473
      },
      "children": [{
        "sourcePosition": {
          "line": 68,
          "column": 37,
          "currentOffset": 2470,
          "endOffset": 2473
        }
      }]
    }, {
      "sourcePosition": {
        "line": 68,
        "column": 46,
        "currentOffset": 2479,
        "endOffset": 2527
      },
      "children": [{
        "sourcePosition": {
          "line": 68,
          "column": 46,
          "currentOffset": 2479,
          "endOffset": 2507
        },
        "children": [{
          "sourcePosition": {
            "line": 68,
            "column": 46,
            "currentOffset": 2479,
            "endOffset": 2503
          },
          "children": [{
            "sourcePosition": {
              "line": 68,
              "column": 50,
              "currentOffset": 2483,
              "endOffset": 2503
            },
            "children": [{
              "sourcePosition": {
                "line": 68,
                "column": 50,
                "currentOffset": 2483,
                "endOffset": 2494
              }
            }]
          }]
        }]
      }, {
        "sourcePosition": {
          "line": 68,
          "column": 79,
          "currentOffset": 2512,
          "endOffset": 2527
        },
        "children": [{
          "sourcePosition": {
            "line": 68,
            "column": 79,
            "currentOffset": 2512,
            "endOffset": 2523
          },
          "children": [{
            "sourcePosition": {
              "line": 68,
              "column": 79,
              "currentOffset": 2512,
              "endOffset": 2518
            }
          }]
        }]
      }]
    }]
  }, {
    "sourcePosition": {
      "line": 69,
      "column": 28,
      "currentOffset": 2557,
      "endOffset": 2571
    },
    "children": [{
      "sourcePosition": {
        "line": 69,
        "column": 39,
        "currentOffset": 2568,
        "endOffset": 2571
      }
    }]
  }, {
    "sourcePosition": {
      "line": 70,
      "column": 28,
      "currentOffset": 2601,
      "endOffset": 2649
    },
    "children": [{
      "sourcePosition": {
        "line": 70,
        "column": 28,
        "currentOffset": 2601,
        "endOffset": 2629
      },
      "children": [{
        "sourcePosition": {
          "line": 70,
          "column": 28,
          "currentOffset": 2601,
          "endOffset": 2625
        },
        "children": [{
          "sourcePosition": {
            "line": 70,
            "column": 32,
            "currentOffset": 2605,
            "endOffset": 2625
          },
          "children": [{
            "sourcePosition": {
              "line": 70,
              "column": 32,
              "currentOffset": 2605,
              "endOffset": 2616
            }
          }]
        }]
      }]
    }, {
      "sourcePosition": {
        "line": 70,
        "column": 61,
        "currentOffset": 2634,
        "endOffset": 2649
      },
      "children": [{
        "sourcePosition": {
          "line": 70,
          "column": 61,
          "currentOffset": 2634,
          "endOffset": 2645
        },
        "children": [{
          "sourcePosition": {
            "line": 70,
            "column": 61,
            "currentOffset": 2634,
            "endOffset": 2640
          }
        }]
      }]
    }]
  }, {
    "sourcePosition": {
      "line": 75,
      "column": 33,
      "currentOffset": 2773,
      "endOffset": 2787
    },
    "children": [{
      "sourcePosition": {
        "line": 75,
        "column": 44,
        "currentOffset": 2784,
        "endOffset": 2787
      }
    }]
  }, {
    "sourcePosition": {
      "line": 63,
      "column": 31,
      "currentOffset": 2242,
      "endOffset": 2256
    },
    "values": [{
      "value": {
        "boolValue": true
      },
      "count": 6
    }, {
      "value": {
        "boolValue": false
      },
      "count": 8
    }],
    "children": [{
      "sourcePosition": {
        "line": 63,
        "column": 42,
        "currentOffset": 2253,
        "endOffset": 2256
      },
      "values": [{
        "value": {
          "stringValue": "alice"
        },
        "count": 14
      }]
    }]
  }, {
    "sourcePosition": {
      "line": 34,
      "column": 23,
      "currentOffset": 756,
      "endOffset": 849
    },
    "values": [{
      "value": {
        "boolValue": true
      },
      "count": 2
    }, {
      "value": {
        "boolValue": false
      },
      "count": 8
    }],
    "children": [{
      "sourcePosition": {
        "line": 34,
        "column": 23,
        "currentOffset": 756,
        "endOffset": 804
      },
      "values": [{
        "value": {
          "boolValue": true
        },
        "count": 4
      }, {
        "value": {
          "boolValue": false
        },
        "count": 6
      }],
      "children": [{
        "sourcePosition": {
          "line": 34,
          "column": 23,
          "currentOffset": 756,
          "endOffset": 770
        },
        "values": [{
          "value": {
            "boolValue": true
          },
          "count": 6
        }, {
          "value": {
            "boolValue": false
          },
          "count": 4
        }],
        "children": [{
          "sourcePosition": {
            "line": 34,
            "column": 34,
            "currentOffset": 767,
            "endOffset": 770
          },
          "values": [{
            "value": {
              "stringValue": "alice"
            },
            "count": 10
          }]
        }]
      }, {
        "sourcePosition": {
          "line": 34,
          "column": 43,
          "currentOffset": 776,
          "endOffset": 804
        },
        "values": [{
          "value": {
            "boolValue": true
          },
          "count": 4
        }, {
          "value": {
            "boolValue": false
          },
          "count": 2
        }, {
          "value": {
          },
          "count": 4
        }],
        "children": [{
          "sourcePosition": {
            "line": 34,
            "column": 44,
            "currentOffset": 777,
            "endOffset": 804
          },
          "values": [{
            "value": {
              "boolValue": false
            },
            "count": 4
          }, {
            "value": {
              "boolValue": true
            },
            "count": 2
          }, {
            "value": {
            },
            "count": 4
          }],
          "children": [{
            "sourcePosition": {
              "line": 34,
              "column": 60,
              "currentOffset": 793,
              "endOffset": 804
            },
            "values": [{
              "value": {
                "mapValue": {
                  "fields": {
                    "first_name": {
                      "stringValue": "Alice"
                    }
                  }
                }
              },
              "count": 2
            }, {
              "value": {
                "mapValue": {
                  "fields": {
                    "is_mentor": {
                      "boolValue": true
                    }
                  }
                }
              },
              "count": 2
            }, {
              "value": {
                "mapValue": {
                  "fields": {
                    "mentorable_courses": {
                      "listValue": {
                        "values": [{
                          "stringValue": "some-course"
                        }, {
                          "stringValue": "some-other-course"
                        }]
                      }
                    }
                  }
                }
              },
              "count": 2
            }, {
              "value": {
              },
              "count": 4
            }]
          }]
        }]
      }]
    }, {
      "sourcePosition": {
        "line": 34,
        "column": 79,
        "currentOffset": 812,
        "endOffset": 849
      },
      "values": [{
        "value": {
          "boolValue": true
        },
        "count": 2
      }, {
        "value": {
        },
        "count": 6
      }, {
        "value": {
          "boolValue": false
        },
        "count": 2
      }],
      "children": [{
        "sourcePosition": {
          "line": 34,
          "column": 80,
          "currentOffset": 813,
          "endOffset": 849
        },
        "values": [{
          "value": {
            "boolValue": false
          },
          "count": 2
        }, {
          "value": {
          },
          "count": 6
        }, {
          "value": {
            "boolValue": true
          },
          "count": 2
        }],
        "children": [{
          "sourcePosition": {
            "line": 34,
            "column": 105,
            "currentOffset": 838,
            "endOffset": 849
          },
          "values": [{
            "value": {
              "mapValue": {
                "fields": {
                  "first_name": {
                    "stringValue": "Alice"
                  }
                }
              }
            },
            "count": 2
          }, {
            "value": {
            },
            "count": 6
          }, {
            "value": {
              "mapValue": {
                "fields": {
                  "mentorable_courses": {
                    "listValue": {
                      "values": [{
                        "stringValue": "some-course"
                      }, {
                        "stringValue": "some-other-course"
                      }]
                    }
                  }
                }
              }
            },
            "count": 2
          }]
        }]
      }]
    }]
  }, {
    "sourcePosition": {
      "line": 84,
      "column": 22,
      "currentOffset": 3188,
      "endOffset": 3247
    },
    "children": [{
      "sourcePosition": {
        "line": 84,
        "column": 22,
        "currentOffset": 3188,
        "endOffset": 3197
      }
    }, {
      "sourcePosition": {
        "line": 84,
        "column": 38,
        "currentOffset": 3204,
        "endOffset": 3247
      },
      "children": [{
        "sourcePosition": {
          "line": 84,
          "column": 38,
          "currentOffset": 3204,
          "endOffset": 3237
        },
        "children": [{
          "sourcePosition": {
            "line": 84,
            "column": 38,
            "currentOffset": 3204,
            "endOffset": 3231
          },
          "children": [{
            "sourcePosition": {
              "line": 84,
              "column": 50,
              "currentOffset": 3216,
              "endOffset": 3231
            },
            "children": [{
              "sourcePosition": {
                "line": 84,
                "column": 50,
                "currentOffset": 3216,
                "endOffset": 3227
              },
              "children": [{
                "sourcePosition": {
                  "line": 84,
                  "column": 50,
                  "currentOffset": 3216,
                  "endOffset": 3222
                }
              }]
            }]
          }]
        }]
      }]
    }]
  }]
};

const REPORT_LIMIT_SIZE = 15

window.onload = function() {
  if (data.rules.files.length == 1) {
    document.body.appendChild(buildFormattedReport(data.report || [], data.rules.files[0].content))
  } else {
    document.body.appendChild(document.createTextNode('Only single-file rules supported. ' +
    'If you encounter this please visit https://github.com/firebase/firebase-tools/issues'))
  }
};

/**
 * Builds the html block with span elements for rule visualization.
 *
 * @param expressionList The list of expression blocks.
 * @param ruleString The full text of the rules with newlines and special characters escaped.
 * @return A <pre> html element with <span></span> around expressions and subexpressions within
 *     .write, .read, and .validate tokens so that they can be selected.
 */
function buildFormattedReport(expressionList, ruleString) {
  const elements = Object.keys(expressionList).map((key) => {
    return mapExpressionBlock(expressionList[key], ruleString)
  })
  const withText = interpolateTextNodes(
    elements,
    ruleString,
    0,
    ruleString.length
  )
  var preElement = document.createElement('pre')
  withText.forEach((element) => preElement.appendChild(element.element))
  return preElement
}

/**
 * Traverses an expression block.
 *
 * Each expression needs to be wrapped in a span and so it's children need to be immediately
 * resolved so they can be added to the element.
 *
 * @param expressionBlock The current recursive chunk of expression data.
 * @param ruleString The full text of the rules with newlines and special characters escaped.
 * @return A single object with at least the keys start, end, and element. Element is the span
 *    element for that [sub]expression. The span element should have all it's children
 *    already added.
 */
function mapExpressionBlock(expressionBlock, ruleString) {
  const start = expressionBlock.sourcePosition.currentOffset
  const end = expressionBlock.sourcePosition.endOffset + 1
  const onlyChildSpans = (expressionBlock.children || []).map(
    (child) => mapExpressionBlock(child, ruleString)
  )
  const allChildren = interpolateTextNodes(
    onlyChildSpans,
    ruleString,
    start,
    end,
    true
  )
  var span = document.createElement('span')
  allChildren.forEach((child) => {
    span.appendChild(child.element)
  })
  span.classList.add('coverage-expr')
  span.title = buildValueString(expressionBlock.values);
  return {
    element: span,
    start: start,
    end: end
  }
}

/**
 * The formatted report data has information about where subexpression are located. It does not,
 * however, have information about text around these expressions. This function takes a formatted
 * list of spans (representing expressions) and puts surrounding text into text elements and
 * returns the list of all elements in that given text-area.
 *
 * @param objs the list of spans to have their bounds interpolated. Each element in the list should
 *    formatted with the keys start, end, and element.
 * @param ruleString The full text of the rules with newlines and special characters escaped.
 * @param optStart An optional start index to start gathering text-elements from.
 * @param optEnd An optional end index to finish gathering text-elements at.
 * @param whether to remove newlines from the text values.
 * @return An interpolated list with all indices from start to end of the ruleString being
 *    included in either a span or a text element.
 */
function interpolateTextNodes(objs, ruleString, start = null, end = null, removeNewLines = false) {
  // Arrays so null objects aren't appended (options)
  const expressionStart = start !== null ? [{'end': start}] : []
  const expressionEnd = end !== null ? [{'start': end}] : []
  const sortedInnerBlocks = (objs || []).sort((a, b) => (a['start'] - b['start']))
  const blocksWithBounds = [].concat(expressionStart, sortedInnerBlocks, expressionEnd)
  const interpolatedBlocks = blocksWithBounds.reduce((allChildren, child, idx) => {
    if (allChildren && allChildren.length) {
      const lastEnd = allChildren[allChildren.length - 1]['end']
      const thisStart = child['start']
      // This is an array so that we don't append null objects
      if (lastEnd < thisStart) {
        const text = ruleString.substring(lastEnd, thisStart)
        const textElement = [{
          element: document.createTextNode(removeNewLines ? text.replace(/\n\s*/g,' ') : text),
          'start': allChildren[allChildren.length - 1]['end'],
          'end': child['start']
        }]
        return allChildren.concat(textElement, child)
      }
    }
    return allChildren.concat(child)
  }, [])
  return interpolatedBlocks.filter(
    (child) => child['start'] !== undefined && child['end'] !== undefined
  )
}

/**
 * Creates the mouse-over text for each span.
 *
 * @param values The array of value objects formatted as {value: **, count: **}.
 * @return A single string for the mouse-over text.
 */
function buildValueString(values) {
  if (!values || !values.length) {
    return 'Expression never evaluated'
  } else if (values.length >= REPORT_LIMIT_SIZE) {
    const allCounts = values.reduce((acc, obj) => acc + obj.count, 0)
    return `${values.length} distinct items returned over ${allCounts} times`
  } else {
    return values.map(({value, count}) => {
      const allowedTypes = ['nullValue', 'boolValue', 'intValue', 'floatValue', 'stringValue',
        'bytesValue', 'durationValue', 'timestampValue', 'latlngValue', 'pathValue']
      const compressedTypes = ['mapValue', 'listValue', 'constraintValue']
      const typeAllowed = allowedTypes.filter(type => value[type] !== undefined).length == 1
      const typeCompressed = compressedTypes.filter(type => value[type] !== undefined).length >= 1
      // Format is value = {returnType: returnValue}
      // A returnType of undefined is an error. Unfortunately the field is called undefined.
      if (value['undefined']) {
        // Expression evaluated to error
        return `Error '${value.undefined.causeMessage}' occurred ${count} time(s)`
      } else if (typeCompressed) {
        // These types are recursive and are hard to read
        return `[object Object] returned ${count} time(s)`
      } else if (typeAllowed) {
        // The response is a simple literal
        // Object.values is not ES2015
        const realValue = Object.keys(value).map((key) => value[key])[0]
        return `Value ${JSON.stringify(realValue)} returned ${count} time(s)`
      } else if (Object.keys(value).length === 0) {
        // Clause not evaluated because of short-circuit.
        return `Expression short-circuited ${count} time(s)`
      } else {
        // For a properly formatted response each value should have one type.
        console.error('Found invalid expression-return type.')
      }
    }).join('\n')
  }
}
</script>
